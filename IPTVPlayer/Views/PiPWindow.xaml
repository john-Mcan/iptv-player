<Window x:Class="IPTVPlayer.Views.PiPWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vlc="clr-namespace:LibVLCSharp.WPF;assembly=LibVLCSharp.WPF"
        Title="PiP" Width="400" Height="225"
        WindowStyle="None"
        Topmost="True"
        ResizeMode="NoResize"
        Background="Black"
        MinWidth="240" MinHeight="135"
        ShowInTaskbar="False">

    <vlc:VideoView x:Name="PipVideoView">
        <Grid x:Name="PipOverlay"
              Background="Black"
              MouseLeftButtonDown="Overlay_MouseLeftButtonDown"
              MouseEnter="Overlay_MouseEnter"
              MouseLeave="Overlay_MouseLeave"
              MouseWheel="Overlay_MouseWheel">

            <!-- Loading indicator (shown while PiP media is starting) -->
            <StackPanel x:Name="PipLoadingPanel"
                        HorizontalAlignment="Center" VerticalAlignment="Center"
                        Panel.ZIndex="5">
                <ProgressBar IsIndeterminate="True" Height="3" Width="80"
                             Foreground="White" Background="#33FFFFFF"
                             BorderThickness="0" Margin="0,0,0,8"/>
                <TextBlock Text="Cargando..." Foreground="#AAAAAA" FontSize="11"
                           HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- Close button (top-right, appears on hover) -->
            <Button x:Name="CloseBtn"
                    Click="CloseButton_Click"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="0,4,4,0"
                    Width="28" Height="28"
                    Opacity="0"
                    Panel.ZIndex="10"
                    Cursor="Hand">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border Background="#CC000000" CornerRadius="14">
                            <TextBlock Text="&#x2715;" Foreground="White"
                                       FontSize="13" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>

            <!-- Volume controls (bottom, appears on hover) -->
            <Border x:Name="ControlsPanel"
                    VerticalAlignment="Bottom"
                    HorizontalAlignment="Stretch"
                    Opacity="0" Margin="0"
                    Panel.ZIndex="10">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#00000000" Offset="0"/>
                        <GradientStop Color="#AA000000" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <StackPanel Orientation="Horizontal" Margin="6,12,6,5"
                            HorizontalAlignment="Left">
                    <Button x:Name="PlayPauseBtn" Click="PlayPauseBtn_Click"
                            Cursor="Hand" Margin="0,0,2,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="Bd" Background="Transparent"
                                        CornerRadius="3" Padding="4,3">
                                    <TextBlock x:Name="PlayPauseIcon" Text="&#xE769;"
                                               FontFamily="Segoe MDL2 Assets" FontSize="13"
                                               Foreground="White"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#33FFFFFF"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button x:Name="MuteBtn" Click="MuteBtn_Click"
                            Cursor="Hand" Margin="0,0,2,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="Bd" Background="Transparent"
                                        CornerRadius="3" Padding="4,3">
                                    <TextBlock x:Name="MuteIcon" Text="&#xE767;"
                                               FontFamily="Segoe MDL2 Assets" FontSize="13"
                                               Foreground="White"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#33FFFFFF"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Slider x:Name="PipVolumeSlider"
                            Style="{StaticResource VolumeSlider}"
                            Width="65" Maximum="100"
                            VerticalAlignment="Center"
                            ValueChanged="PipVolumeSlider_ValueChanged"/>
                </StackPanel>
            </Border>

            <!-- Invisible resize grip (bottom-right corner, cursor hints resizability) -->
            <Border HorizontalAlignment="Right" VerticalAlignment="Bottom"
                    Width="14" Height="14" Cursor="SizeNWSE"
                    Background="Transparent"
                    Panel.ZIndex="20"
                    MouseLeftButtonDown="ResizeGrip_MouseDown"
                    MouseMove="ResizeGrip_MouseMove"
                    MouseLeftButtonUp="ResizeGrip_MouseUp"/>
        </Grid>
    </vlc:VideoView>
</Window>
